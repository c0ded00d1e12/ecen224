<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="">

<title>
    
    Assembly â€¢ ECEn 224: Intro to Computer Systems
    
</title>

<!-- Bootstrap core CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
    integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">

<!-- Custom styles for this template -->
<link rel="stylesheet" href=/ecen224/css/main.css>

<!-- <link href="https://fonts.googleapis.com/css?family=Ubuntu&display=swap" rel="stylesheet"> -->
<!-- <link href="https://fonts.googleapis.com/css2?family=Ubuntu+Mono&display=swap" rel="stylesheet"> -->
<link rel="stylesheet" href="https://use.typekit.net/jcn6ybb.css">

<link rel="icon" type="image/png" sizes="96x96" href=/ecen224/icon/favicon-96x96.png>
<link rel="icon" type="image/png" sizes="32x32" href=/ecen224/icon/favicon-32x32.png>
<link rel="icon" type="image/png" sizes="16x16" href=/ecen224/icon/favicon-16x16.png>

<script src="https://kit.fontawesome.com/624d595ebf.js" crossorigin="anonymous"></script>


</head>

<body>
  <div class="d-flex" id="wrapper">
    <!-- Sidebar -->
<div class="border-right" id="sidebar-wrapper">
    <div class="sidebar-sticky">
        <div class="sidebar-heading-big">
            <a href="/ecen224/"><img src="/ecen224/icon/icon.svg">
                ECEn 224</a>
        </div>

        <div class="list-group list-group-flush">
            
            <!-- Look for specific front-matter tag -->
            
            <a href="/ecen224/overview/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fa-duotone fa-chalkboard-teacher"></i>
                
                Overview
            </a>
            
            
            <!-- Look for specific front-matter tag -->
            
            <a href="/ecen224/resources/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fa-duotone fa-book"></i>
                
                Resources
            </a>
            
            
            <!-- Look for specific front-matter tag -->
            
            <a href="/ecen224/coding-standard/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fa-duotone fa-terminal"></i>
                
                Coding Standard
            </a>
            
            
            <!-- Look for specific front-matter tag -->
            
            <a href="/ecen224/lab-setup/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fa-duotone fa-wrench"></i>
                
                Lab Setup
            </a>
            
            
            <!-- Look for specific front-matter tag -->
            
            <a href="/ecen224/ta-hours/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fas fa-user-clock"></i>
                
                TA Hours
            </a>
            
            
            <!-- Look for specific front-matter tag -->
            
            <a href="http://diglabqueue.groups.et.byu.net" class="list-group-item list-group-item-action sidebar-item" target="_blank" rel="noopener noreferrer">
                
                <i class="fa-duotone fa-handshake-angle"></i>
                
                Help Queue
            </a>
            
            
            <!-- Look for specific front-matter tag -->
            
            <a href="https://learningsuite.byu.edu/.N7cA/cid-qWPtDGbD9Vq6/calendar" class="list-group-item list-group-item-action sidebar-item" target="_blank" rel="noopener noreferrer">
                
                <i class="fa-duotone fa-calendar"></i>
                
                Schedule
            </a>
            
            
            <!-- Look for specific front-matter tag -->
            
            <a href="/ecen224/recitations/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fa-duotone fa-podium"></i>
                
                Recitations
            </a>
            
            
        </div>

        <div class="sidebar-heading">Labs</div>
        <div class="list-group list-group-flush">
            
            <a href="/ecen224/labs/getting-started/" class="list-group-item list-group-item-action sidebar-item">
                <span class="badge badge-pill badge-dark-grey">1</span>
                Getting Started
            </a>
            
            <a href="/ecen224/labs/command-line/" class="list-group-item list-group-item-action sidebar-item">
                <span class="badge badge-pill badge-dark-grey">2</span>
                Command Line
            </a>
            
            <a href="/ecen224/labs/c-programming/" class="list-group-item list-group-item-action sidebar-item">
                <span class="badge badge-pill badge-dark-grey">3</span>
                C Programming
            </a>
            
            <a href="/ecen224/labs/debugging/" class="list-group-item list-group-item-action sidebar-item">
                <span class="badge badge-pill badge-dark-grey">4</span>
                Debugging
            </a>
            
            <a href="/ecen224/labs/image/" class="list-group-item list-group-item-action sidebar-item">
                <span class="badge badge-pill badge-dark-grey">5</span>
                Image
            </a>
            
            <a href="/ecen224/labs/display/" class="list-group-item list-group-item-action sidebar-item">
                <span class="badge badge-pill badge-dark-grey">6</span>
                Display
            </a>
            
            <a href="/ecen224/labs/io/" class="list-group-item list-group-item-action sidebar-item">
                <span class="badge badge-pill badge-dark-grey">7</span>
                I/O
            </a>
            
            <a href="/ecen224/labs/camera/" class="list-group-item list-group-item-action sidebar-item">
                <span class="badge badge-pill badge-dark-grey">8</span>
                Camera
            </a>
            
            <a href="/ecen224/labs/client/" class="list-group-item list-group-item-action sidebar-item">
                <span class="badge badge-pill badge-dark-grey">9</span>
                Client
            </a>
            
            <a href="/ecen224/labs/threaded-client/" class="list-group-item list-group-item-action sidebar-item">
                <span class="badge badge-pill badge-dark-grey">10</span>
                Threaded Client
            </a>
            
            <a href="/ecen224/labs/doorbell/" class="list-group-item list-group-item-action sidebar-item">
                <span class="badge badge-pill badge-dark-grey">11</span>
                Doorbell
            </a>
            
        </div>

        <div class="sidebar-heading">Programming Assignments</div>
        <div class="list-group list-group-flush">
            
            <a href="/ecen224/programming-assignments/bomb-lab/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fa-duotone fa-bomb"></i>
                
                Bomb Lab
            </a>
            
            <a href="/ecen224/programming-assignments/attack-lab/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fa-duotone fa-bow-arrow"></i>
                
                Attack Lab
            </a>
            
        </div>

        <!-- <div class="sidebar-heading">Homeworks</div>
        <div class="list-group list-group-flush">
            
            <a href="/ecen224/homework/data/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fa-duotone fa-binary"></i>
                
                Data
            </a>
            
            <a href="/ecen224/homework/c/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fa-duotone fa-brackets-curly"></i>
                
                C
            </a>
            
            <a href="/ecen224/homework/assembly/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fa-duotone fa-microchip"></i>
                
                Assembly
            </a>
            
            <a href="/ecen224/homework/memory/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fa-duotone fa-memory"></i>
                
                Memory
            </a>
            
            <a href="/ecen224/homework/io/" class="list-group-item list-group-item-action sidebar-item">
                
                <i class="fa-duotone fa-server"></i>
                
                I/O
            </a>
            
        </div> -->
    </div>
</div>
<!-- /#sidebar-wrapper -->


    <!-- Page Content -->
    <div id="page-content-wrapper">

      <nav class="navbar sticky-top navbar-expand-lg border-bottom">
    <button class="btn btn-brand" id="menu-toggle">
        <i class="fas fa-bars"></i>
    </button>

    <a href="#" class="navbar-brand mb-0 h1 page-title-bar text-center mx-auto" id="page-title-bar"></a>

    
    <ul class="navbar-nav">
        <li class="nav-item">
            <a class="nav-link btn btn-brand suggest-edits" target="_blank" rel="noopener noreferrer noopener noreferrer" href="https://github.com/byu-cpe/ecen224/issues/new?title=Suggestions+for+Assembly+Page"><i class="fab fa-github"></i> Suggest
                Edits</a>
        </li>
    </ul>
    
</nav>


      <div class="container">
        <style></style>
<article class="page">
    <h1 class="page-title" id="page-title">
        Assembly Homework
    </h1>

    <div class="page-content">
        

        <p>For all questions, you should compile the C code you come up with for the function and try to match the assembly code exactly. Use the Digital Lab computers to compile your code with the following <code class="language-plaintext highlighter-rouge">gcc flags: gcc -Og -S &lt;name_of_source_file&gt;</code>. For each problem, create a C file with the name, <code class="language-plaintext highlighter-rouge">pX.c</code>, where X is the number of the question. So for question 1, your answer will be in <code class="language-plaintext highlighter-rouge">p1.c</code>. You will need to write a main function that calls the mystery function as well as filling out the mystery function. To turn in the lab, zip up all of the source files together and upload it to Learning Suite.</p>

<ol>
  <li>(1 point) Fill in the function using the following assembly code.
    <div class="language-c highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> <span class="kt">int</span> <span class="nf">mystery</span><span class="p">(</span><span class="cm">/* Add arguments here */</span> <span class="p">)</span> <span class="p">{</span>
     <span class="cm">/* Put something here */</span>
 <span class="p">}</span>
</code></pre></div>    </div>

    <div class="language-nasm highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> <span class="nl">mystery:</span>
     <span class="nf">addl</span> <span class="o">%</span><span class="nb">edi</span><span class="p">,</span> <span class="o">%</span><span class="nb">esi</span>
     <span class="nf">leal</span> <span class="p">(</span><span class="o">%</span><span class="nb">rsi</span><span class="p">,</span><span class="o">%</span><span class="nb">rsi</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="o">%</span><span class="nb">edx</span>
     <span class="nf">leal</span> <span class="mi">0</span><span class="p">(,</span><span class="o">%</span><span class="nb">rdx</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="o">%</span><span class="nb">eax</span>
     <span class="nf">ret</span>
</code></pre></div>    </div>
  </li>
  <li>(1 point) Fill in the function using the following assembly code.
    <div class="language-c highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> <span class="kt">int</span> <span class="nf">mystery</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
     <span class="cm">/* Put something here */</span>
 <span class="p">}</span>
</code></pre></div>    </div>
    <div class="language-nasm highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> <span class="nl">mystery:</span>
     <span class="nf">testl</span> <span class="o">%</span><span class="nb">edi</span><span class="p">,</span> <span class="o">%</span><span class="nb">edi</span>
     <span class="nf">je</span> <span class="nv">.L3</span>
     <span class="nf">movl</span> <span class="o">%</span><span class="nb">edi</span><span class="p">,</span> <span class="o">%</span><span class="nb">eax</span>
     <span class="nf">sall</span> <span class="kc">$</span><span class="mi">4</span><span class="p">,</span> <span class="o">%</span><span class="nb">eax</span>
     <span class="nf">ret</span>
 <span class="nl">.L3:</span>
     <span class="nf">movl</span> <span class="kc">$</span><span class="mi">5</span><span class="p">,</span> <span class="o">%</span><span class="nb">eax</span>
     <span class="nf">ret</span>
</code></pre></div>    </div>
  </li>
  <li>(1 point) Fill in the function using the following assembly code.
    <div class="language-c highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> <span class="kt">long</span> <span class="nf">mystery_loop</span><span class="p">(</span><span class="kt">long</span> <span class="n">start</span><span class="p">,</span> <span class="kt">long</span> <span class="n">max</span><span class="p">)</span> <span class="p">{</span>
     <span class="cm">/* Put something here */</span>
 <span class="p">}</span>
</code></pre></div>    </div>

    <div class="language-nasm highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> <span class="nl">mystery_loop:</span>
     <span class="nf">movq</span> <span class="o">%</span><span class="nb">rdi</span><span class="p">,</span> <span class="o">%</span><span class="nb">rax</span>
     <span class="nf">movl</span> <span class="kc">$</span><span class="mi">0</span><span class="p">,</span> <span class="o">%</span><span class="nb">edx</span>
 <span class="nl">.L2:</span>
     <span class="nf">addq</span> <span class="o">%</span><span class="nb">rax</span><span class="p">,</span> <span class="o">%</span><span class="nb">rax</span>
     <span class="nf">addq</span> <span class="kc">$</span><span class="mi">1</span><span class="p">,</span> <span class="o">%</span><span class="nb">rdx</span>
     <span class="nf">cmpq</span> <span class="o">%</span><span class="nb">rsi</span><span class="p">,</span> <span class="o">%</span><span class="nb">rdx</span>
     <span class="nf">jl</span> <span class="nv">.L2</span>
     <span class="nf">rep</span> <span class="nv">ret</span>
</code></pre></div>    </div>

    <div class="alert alert-secondary" role="alert">
 Note: On the last line, ignore the <code>rep</code> and treat it as just a <code>ret</code>. If you are interested, here is a <a href="https://stackoverflow.com/questions/20526361/what-does-rep-ret-mean" target="_blank" rel="noopener noreferrer">Stack Overflow question about it.</a>
 </div>
  </li>
  <li>(3 points) Fill in the function using the following assembly code.
    <div class="language-c highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> <span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
     <span class="kt">long</span> <span class="n">x</span><span class="p">;</span>
     <span class="kt">long</span> <span class="n">y</span><span class="p">;</span>
 <span class="p">}</span> <span class="n">point_t</span><span class="p">;</span>
 <span class="kt">void</span> <span class="nf">mystery_struct</span><span class="p">(</span><span class="n">point_t</span> <span class="o">*</span><span class="n">point</span><span class="p">)</span> <span class="p">{</span>
     <span class="cm">/* Put something here */</span>
 <span class="p">}</span>
</code></pre></div>    </div>

    <div class="language-nasm highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> <span class="nl">mystery_struct:</span>
     <span class="nf">movq</span> <span class="p">(</span><span class="o">%</span><span class="nb">rdi</span><span class="p">),</span> <span class="o">%</span><span class="nb">rax</span>
     <span class="nf">testq</span> <span class="o">%</span><span class="nb">rax</span><span class="p">,</span> <span class="o">%</span><span class="nb">rax</span>
     <span class="nf">jle</span> <span class="nv">.L2</span>
     <span class="nf">movq</span> <span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="nb">rdi</span><span class="p">),</span> <span class="o">%</span><span class="nb">rdx</span>
     <span class="nf">movq</span> <span class="o">%</span><span class="nb">rdx</span><span class="p">,</span> <span class="p">(</span><span class="o">%</span><span class="nb">rdi</span><span class="p">)</span>
     <span class="nf">movq</span> <span class="o">%</span><span class="nb">rax</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="nb">rdi</span><span class="p">)</span>
     <span class="nf">ret</span>
 <span class="nl">.L2:</span>
     <span class="nf">cmpq</span> <span class="kc">$</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="nb">rdi</span><span class="p">)</span>
     <span class="nf">jle</span> <span class="nv">.L4</span>
     <span class="nf">addq</span> <span class="kc">$</span><span class="mi">9</span><span class="p">,</span> <span class="o">%</span><span class="nb">rax</span>
     <span class="nf">movq</span> <span class="o">%</span><span class="nb">rax</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="nb">rdi</span><span class="p">)</span>
     <span class="nf">ret</span>
 <span class="nl">.L4:</span>
     <span class="nf">movq</span> <span class="kc">$</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="o">%</span><span class="nb">rdi</span><span class="p">)</span>
     <span class="nf">movq</span> <span class="kc">$</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="nb">rdi</span><span class="p">)</span>
     <span class="nf">ret</span>
</code></pre></div>    </div>
  </li>
  <li>(6 points) Fill in the switch statement using the following assembly code.
    <div class="language-c highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> <span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span> <span class="n">MODE_A</span><span class="p">,</span> <span class="n">MODE_B</span><span class="p">,</span> <span class="n">MODE_C</span><span class="p">,</span> <span class="n">MODE_D</span><span class="p">,</span> <span class="n">MODE_E</span> <span class="p">}</span> <span class="n">mode_t</span><span class="p">;</span>
 <span class="kt">long</span> <span class="nf">mystery_switch</span><span class="p">(</span><span class="kt">long</span> <span class="o">*</span><span class="n">p1</span><span class="p">,</span> <span class="kt">long</span> <span class="o">*</span><span class="n">p2</span><span class="p">,</span> <span class="n">mode_t</span> <span class="n">action</span><span class="p">)</span> <span class="p">{</span>
     <span class="kt">long</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
     <span class="k">switch</span> <span class="p">(</span><span class="n">action</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">case</span> <span class="n">MODE_A</span><span class="p">:</span>
             <span class="cm">/* Put something here */</span>
         <span class="k">case</span> <span class="n">MODE_B</span><span class="p">:</span>
             <span class="cm">/* Put something here */</span>
         <span class="k">case</span> <span class="n">MODE_C</span><span class="p">:</span>
             <span class="cm">/* Put something here */</span>
         <span class="k">case</span> <span class="n">MODE_D</span><span class="p">:</span>
             <span class="cm">/* Put something here */</span>
         <span class="k">case</span> <span class="n">MODE_E</span><span class="p">:</span>
             <span class="cm">/* Put something here */</span>
         <span class="nl">default:</span>
             <span class="cm">/* Put something here */</span>
     <span class="p">}</span>
     <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
 <span class="p">}</span>
</code></pre></div>    </div>

    <div class="language-nasm highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> <span class="nl">.L8:</span>                    <span class="c1">; MODE_E</span>
     <span class="nf">movl</span> <span class="kc">$</span><span class="mi">27</span><span class="p">,</span> <span class="o">%</span><span class="nb">eax</span>
     <span class="nf">ret</span>
 <span class="nl">.L3:</span>                    <span class="c1">; MODE_A</span>
     <span class="nf">movq</span> <span class="p">(</span><span class="o">%</span><span class="nb">rsi</span><span class="p">),</span> <span class="o">%</span><span class="nb">rax</span>
     <span class="nf">movq</span> <span class="p">(</span><span class="o">%</span><span class="nb">rdi</span><span class="p">),</span> <span class="o">%</span><span class="nb">rdx</span>
     <span class="nf">movq</span> <span class="o">%</span><span class="nb">rdx</span><span class="p">,</span> <span class="p">(</span><span class="o">%</span><span class="nb">rsi</span><span class="p">)</span>
     <span class="nf">ret</span>
 <span class="nl">.L5:</span>                    <span class="c1">; MODE_B</span>
     <span class="nf">movq</span> <span class="p">(</span><span class="o">%</span><span class="nb">rdi</span><span class="p">),</span> <span class="o">%</span><span class="nb">rax</span>
     <span class="nf">addq</span> <span class="p">(</span><span class="o">%</span><span class="nb">rsi</span><span class="p">),</span> <span class="o">%</span><span class="nb">rax</span>
     <span class="nf">movq</span> <span class="o">%</span><span class="nb">rax</span><span class="p">,</span> <span class="p">(</span><span class="o">%</span><span class="nb">rdi</span><span class="p">)</span>
     <span class="nf">ret</span>
 <span class="nl">.L6:</span>                    <span class="c1">; MODE_C</span>
     <span class="nf">movq</span> <span class="kc">$</span><span class="mi">59</span><span class="p">,</span> <span class="p">(</span><span class="o">%</span><span class="nb">rdi</span><span class="p">)</span>
     <span class="nf">movq</span> <span class="p">(</span><span class="o">%</span><span class="nb">rsi</span><span class="p">),</span> <span class="o">%</span><span class="nb">rax</span>
     <span class="nf">ret</span>
 <span class="nl">.L7:</span>                    <span class="c1">; MODE_D</span>
     <span class="nf">movq</span> <span class="p">(</span><span class="o">%</span><span class="nb">rsi</span><span class="p">),</span> <span class="o">%</span><span class="nb">rax</span>
     <span class="nf">movq</span> <span class="o">%</span><span class="nb">rax</span><span class="p">,</span> <span class="p">(</span><span class="o">%</span><span class="nb">rdi</span><span class="p">)</span>
     <span class="nf">movl</span> <span class="kc">$</span><span class="mi">27</span><span class="p">,</span> <span class="o">%</span><span class="nb">eax</span>
     <span class="nf">ret</span>
 <span class="nf">.L9</span>                     <span class="c1">; default</span>
     <span class="nf">movl</span> <span class="kc">$</span><span class="mi">12</span><span class="p">,</span> <span class="o">%</span><span class="nb">eax</span>
     <span class="nf">ret</span>
</code></pre></div>    </div>
  </li>
</ol>


        
    </div>
</article>

      </div>
    </div>
    <!-- /#page-content-wrapper -->

  </div>
  <!-- /#wrapper -->

  <!-- Bootstrap core JavaScript -->
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
<script src="/ecen224/js/jquery.visible.min.js"></script>

<!-- Menu Toggle Script -->
<script>
    $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });

    var prevVisible = $('#page-title').visible();

    $(window).scroll(function () {
        currentVisible = $('#page-title').visible()
        if (prevVisible && !currentVisible) {
            console.log("Do something!");
            $("#page-title-bar").html($('#page-title').text());
        }

        if (!prevVisible && currentVisible) {
            $("#page-title-bar").html("")
        }

        prevVisible = currentVisible;
    });

</script>

<!-- Copy button for code blocks -->
<script>
    const copyButtonLabel = "Copy";

    // use a class selector if available
    let blocks = document.querySelectorAll("pre");

    blocks.forEach((block) => {
        // only add button if browser supports Clipboard API
        if (navigator.clipboard) {
            let button = document.createElement("button");
            button.className = 'btn btn-brand btn-sm';

            button.innerText = copyButtonLabel;
            block.parentNode.parentNode.insertBefore(button, block.parentNode);

            button.addEventListener("click", async () => {
                await copyCode(block, button);
            });
        }
    });

    async function copyCode(block, button) {
        let code = block.querySelector("code");
        let text = code.innerText;

        await navigator.clipboard.writeText(text);

        // visual feedback that task is completed
        button.innerText = "Copied";

        setTimeout(() => {
            button.innerText = copyButtonLabel;
        }, 700);
    }
</script>


</body>

</html>